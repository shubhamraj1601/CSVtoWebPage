<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSV Viewer with HTML, CSS & JavaScript</title>
    <!-- <link rel="stylesheet" type="text/css" href="css/style.css" /> -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.2.0/papaparse.min.js"></script>
    <!-- <script src="https://app.awesome-table.com/AwesomeTableInclude.js"></script> -->
  </head>
  <body>
    <input type="file" id="csvFileInput" style="padding-bottom: 15px" />
    <table id="csvRoot"></table>
    <!-- <div data-type="AwesomeTableView" data-hide-filters="false" data-filters="" data-viewID="-MfaaJk0qFT2UbdENSv1"></div> -->
  </body>
</html>

<script>
  class TableCsv {
    /**
      @param {HTMLTableElement} root
    *
    */
    constructor(root) {
      this.root = root;
    }

    /**
     *
     *
     * @param {string[][]} data
     * @param {string[]} headerColumns
     */
    update(data, headerColumns = []) {
      this.clear();
      this.setHeader(headerColumns);
      this.setBody(data);
    }

    clear() {
      this.root.innerHTML = "";
    }

    /**
     *
     *
     * @param {string[]} headerColumns
     */
    setHeader(headerColumns) {
      this.root.insertAdjacentHTML(
        "afterbegin",
        `
            <thead>
                <tr>
                    ${headerColumns.map((text) => `<th>${text}</th>`).join("")}
                </tr>
            </thead>
        `
      );
    }

    /**
     *
     *
     * @param {string[][]} data
     */
    setBody(data) {
      const rowsHtml = data.map((row) => {
        return `
                <tr>
                    ${row.map((text) => `<td>${text}</td>`).join("")}
                </tr>
            `;
      });

      this.root.insertAdjacentHTML(
        "beforeend",
        `
            <tbody>
                ${rowsHtml.join("")}
            </tbody>
        `
      );
    }
  }

  const tableRoot = document.querySelector("#csvRoot");
  const csvFileInput = document.querySelector("#csvFileInput");
  const tableCsv = new TableCsv(tableRoot);

  csvFileInput.addEventListener("change", (e) => {
    Papa.parse(csvFileInput.files[0], {
      delimiter: ",",
      skipEmptyLines: true,
      complete: (results) => {
        tableCsv.update(results.data.slice(1), results.data[0]);
      },
    });
  });
</script>
